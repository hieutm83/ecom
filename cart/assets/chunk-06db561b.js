import{a,b as v,c as u,g as Le,d as oe}from"./chunk-5d6d9427.js";import{p as j,s as _,g as T,a as Ve,i as ae,b as le,h as f,m as R,c as k,o as g,d as De,r as Ke,e as Ge,l as F,f as ue,j as ze,k as Ye,n as ce,q as Je,t as fe,u as Me,v as de,w as U,x as qe,y as Xe}from"./chunk-8505b20b.js";function ge(){const e="/";return Qe(e)?"/":e}function Qe(e){return!!e.startsWith("http")}function he(e){return!e.startsWith("/")&&!e.startsWith(".")&&!e.startsWith("?")&&e!==""}function Ze(e,t){let n=!1;return()=>{n||(n=!0,setTimeout(()=>{n=!1,e()},t))}}function et(e){return j(e,"/").pathname}function H(e){window.location.href=e}const tt="/";function nt(e,t,n){a(t!==".pageContext.json"||n===!0,{fileExtension:t,doNotCreateExtraDirectory:n});const{pathnameOriginal:r,searchOriginal:i,hashOriginal:o}=j(e,tt);e.startsWith("/")&&a(e===`${r}${i||""}${o||""}`,{url:e});let s=r;if(n)s.endsWith("/")&&(s=_(s,0,-1)),a(!s.endsWith("/"),{url:e,pathnameModified:s}),s===""&&(s="/index");else{const d=r.endsWith("/")?"":"/";s=s+`${d}index`}return`${s}${t}${i||""}${o||""}`}function P(e){return typeof e!="object"||e===null?!1:Object.getPrototypeOf(e)===null?!0:e.constructor.name==="Object"}function rt(){return!!it()}function it(){var e,t,n,r;const i=!!(!((t=(e=window.__REACT_DEVTOOLS_GLOBAL_HOOK__)===null||e===void 0?void 0:e.renderers)===null||t===void 0)&&t.size),o=!!(!((r=(n=window.__REACT_DEVTOOLS_GLOBAL_HOOK__)===null||n===void 0?void 0:n.rendererInterfaces)===null||r===void 0)&&r.size),s=!!window.__vite_plugin_react_preamble_installed__,l=d=>{v(d,"An internal heuristic needs to be updated, see https://github.com/brillout/vite-plugin-ssr/issues/423",{onlyOnce:!0})};return i||o?(l(i&&s),!0):s?(a(i===!1&&o===!1),!0):!1}function st(e,t){return(e==null?void 0:e.message)===(t==null?void 0:t.message)}function ot(e){return new Promise(t=>setTimeout(t,e))}const at=T();let q=!1;const pe={markNavigationChange(){q=!0},get noNavigationChangeYet(){return!q&&this.isFirstUrl(T())},isFirstUrl(e){return e===at}};function X(e){return"["+e.map(t=>"'"+t+"'").join(", ")+"]"}function B(e,t){const n=Object.getOwnPropertyDescriptor(e,t);return!!n&&!("value"in n)&&!!n.get}function me(e,t){return Ve(e,t)}async function lt(e,t){const r=me(e,t).filter(o=>o.fileType===".page.server");return await Promise.all(r.map(async o=>{o.exportNames||(a(o.loadExportNames,t),await o.loadExportNames())})),{hasOnBeforeRenderServerSideOnlyHook:r.some(({exportNames:o})=>(a(o),o.includes("onBeforeRender")))}}function ye(e,{hook:t,errorMessagePrefix:n}){if(!n){a(t);const{hookName:r,hookFilePath:i}=t;a(i.startsWith("/")),a(!r.endsWith(")")),n=`The \`pageContext\` provided by the \`export { ${r} }\` of ${i}`}u(ae(e),`${n} should be an object.`),u(!("_objectCreatedByVitePluginSsr"in e),`${n} should not be the whole \`pageContext\` object, see https://vite-plugin-ssr.com/pageContext-manipulation#do-not-return-entire-pagecontext`),v(!("_pageId"in e),"You are using `onBeforeRoute()` to override vite-plugin-ssr routing. This is experimental: make sure to contact a vite-plugin-ssr maintainer before using this.",{onlyOnce:!0})}function ut(e,t,n,r){a(!t.endsWith(")"));const i=`The \`export { ${t} }\` of ${r}`;u(e==null||P(e),`${i} should return \`null\`, \`undefined\`, or a plain JavaScript object.`),e!=null&&(ct(e,n,i),"pageContext"in e&&ye(e.pageContext,{hook:{hookName:t,hookFilePath:r}}))}function ct(e,t,n){const r=[],i=Object.keys(e);for(const o of i)t.includes(o)||r.push(o);u(r.length===0,[n,"returned an object with unknown keys",X(r)+".","Only following keys are allowed:",X(t)+"."].join(" "))}function K(e){a(e.urlOriginal),"urlPathname"in e?a(B(e,"urlPathname")):Object.defineProperty(e,"urlPathname",{get:ve,enumerable:!0,configurable:!0}),"url"in e?a(B(e,"url")):Object.defineProperty(e,"url",{get:ft,enumerable:!1,configurable:!0}),"urlParsed"in e?a(B(e,"urlParsed")):Object.defineProperty(e,"urlParsed",{get:dt,enumerable:!0,configurable:!0})}function be(e){let t=e.urlOriginal;const{_baseUrl:n,_urlProcessor:r}=e;return a(n.startsWith("/")),a(r===null||le(r)),r!==null&&(t=r(t)),j(t,n)}function ve(){const{pathname:e}=be(this),t=e;return a(t.startsWith("/")),t}function ft(){return v(!1,"`pageContext.url` is outdated. Use `pageContext.urlPathname`, `pageContext.urlParsed`, or `pageContext.urlOriginal` instead. (See https://vite-plugin-ssr.com/migration/0.4.23 for more information.)",{onlyOnce:!0,showStackTrace:!0}),ve.call(this)}function dt(){const e=be(this),{origin:t,pathname:n,pathnameOriginal:r,search:i,searchAll:o,searchOriginal:s,hash:l,hashOriginal:d}=e,h={origin:t,pathname:n,pathnameOriginal:r,search:i,searchAll:o,searchOriginal:s,hash:l,hashOriginal:d,get hashString(){return v(!1,"`pageContext.urlParsed.hashString` has been renamed to `pageContext.urlParsed.hashOriginal`",{onlyOnce:!0,showStackTrace:!0}),d},get searchString(){return v(!1,"`pageContext.urlParsed.searchString` has been renamed to `pageContext.urlParsed.searchOriginal`",{onlyOnce:!0,showStackTrace:!0}),s}};return Q(h,"hashString"),Q(h,"searchString"),h}function Q(e,t){const n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(e,t,{...n,enumerable:!1})}function gt(e){a(typeof e.urlOriginal=="string"),a(typeof e.urlPathname=="string"),a(P(e.urlParsed)),a(e.urlPathname===e.urlParsed.pathname)}function ht(e,t){if(!P(e))return!1;for(const n of Object.keys(e))if(!t.includes(n))return!1;return!0}function pt(e){return f(e,"then")&&le(e.then)}const G="@",D=":";function z(e,t){u(e==="*"||e.startsWith("/"),`Invalid route string \`${e}\`${e===""?" (empty string)":""}: route strings should start with a leading slash \`/\` (or be \`*\`).`),a(t.startsWith("/"));const n=e.split("/"),r=t.split("/"),i={};mt(e),e==="*"&&(e="/*");for(let o=0;o<Math.max(n.length,r.length);o++){const s=n[o],l=r[o];if(s==="*")return i["*"]=r.slice(Math.max(1,o)).join("/"),{routeParams:i};if(s&&E(s)){if(v(!s.startsWith(D),`Outdated route string \`${e}\`, use \`${e.split(D).join(G)}\` instead.`,{onlyOnce:!0}),!l)return null;i[s.slice(1)]=l}else if((s||"")!==(l||""))return null}return{routeParams:i}}function mt(e){const t=e.split("*").length-1;u(t<=1,`Invalid route string \`${e}\`: route strings are not allowed to contain more than one glob character \`*\`.`),u(t===0||t===1&&e.endsWith("*"),`Invalid route string \`${e}\`: make sure your route string ends with the glob character \`*\`.`)}function x(e){const t=e.split("/").filter(s=>s!==""&&s!=="*");let n=0;for(const s of t){if(E(s))break;n++}const r=t.filter(s=>!E(s)).length,i=t.filter(s=>E(s)).length,o=e.endsWith("*");return{numberOfParameterSegments:i,numberOfStaticSegmentsBeginning:n,numberOfStaticSegements:r,isCatchAll:o}}function E(e){return e.startsWith(G)||e.startsWith(D)}function Z(e){const n=z(e,e);return n!==null&&Object.keys(n.routeParams).length===0}function yt(e){e.sort(bt).sort(R(t=>t.routeType==="FUNCTION"&&!!t.precedence&&t.precedence<0)).sort(R(t=>t.routeType==="STRING"&&Z(t.routeString)===!1)).sort(R(t=>t.routeType==="FUNCTION"&&!t.precedence)).sort(R(t=>t.routeType==="STRING"&&Z(t.routeString)===!0)).sort(R(t=>t.routeType==="FILESYSTEM")).sort(R(t=>t.routeType==="FUNCTION"&&!!t.precedence&&t.precedence>0))}function bt(e,t){var n,r;{const i=(n=e.precedence)!==null&&n!==void 0?n:0,o=(r=t.precedence)!==null&&r!==void 0?r:0;if(i!==o)return i>o?-1:1}if(!t.routeString||!e.routeString)return 0;{const o=k(s=>x(s).numberOfStaticSegmentsBeginning)(e.routeString,t.routeString);if(o!==0)return o}{const o=k(s=>x(s).numberOfStaticSegements)(e.routeString,t.routeString);if(o!==0)return o}{const o=k(s=>x(s).numberOfParameterSegments)(e.routeString,t.routeString);if(o!==0)return o}{if(x(t.routeString).isCatchAll)return-1;if(x(e.routeString).isCatchAll)return 1}return 0}function vt(e,t){return St(e)?z(e,t):Pt(e,t)}function Pt(e,t){return t=wt(t),a(t.startsWith("/")),a(e.startsWith("/")),a(!t.endsWith("/")||t==="/"),a(!e.endsWith("/")||e==="/"),t!==e?null:{routeParams:{}}}function wt(e){if(!e.endsWith("/"))return e;for(;e.endsWith("/");)e=_(e,0,-1);return e===""?"/":e}function Rt(e,t){const r=t.filter(({filesystemRoot:o})=>e.startsWith(o)).sort(k(({filesystemRoot:o})=>o.length))[0];let i;if(r){const{filesystemRoot:o,routeRoot:s}=r,l={pageId:e,filesystemRoot:o,routeRoot:s};a(s.startsWith("/")&&e.startsWith("/")&&o.startsWith("/"),l),a(e.startsWith(o),l),o!=="/"?(a(!o.endsWith("/"),l),i=_(e,o.length,0)):i=e,a(i.startsWith("/"),l),i=s+(s.endsWith("/")?"":"/")+_(i,1,0)}else i=e;return a(i.startsWith("/")),i=i.split("/").filter(o=>o!=="pages"&&o!=="src"&&o!=="index").join("/"),a(!i.includes(".page.")),a(!i.endsWith(".")),i.endsWith("/index")&&(i=_(i,0,-6)),i===""&&(i="/"),a(i.startsWith("/")),a(!i.endsWith("/")||i==="/"),i}function St(e){return e.includes(G)}async function _t(e,t,n){gt(t);let r=e.default(t);if(u(!pt(r)||e.iKnowThePerformanceRisksOfAsyncRouteFunctions,`The Route Function ${n} returned a promise; async route functions are opt-in, see https://vite-plugin-ssr.com/route-function#async`),r=await r,r===!1)return null;if(r===!0&&(r={}),u(P(r),`The Route Function ${n} should return a boolean or a plain JavaScript object, instead it returns \`${f(r,"constructor")?r.constructor:r}\`.`),"match"in r){const{match:s}=r;if(u(typeof s=="boolean",`The \`match\` value returned by the Route Function ${n} should be a boolean.`),!s)return null}let i=null;"precedence"in r&&(i=r.precedence,u(typeof i=="number",`The \`precedence\` value returned by the Route Function ${n} should be a number.`)),Pe(r,`The \`routeParams\` object returned by the Route Function ${n} should`);const o=r.routeParams||{};return u(!("pageContext"in r),"Providing `pageContext` in Route Functions is forbidden, see https://vite-plugin-ssr.com/route-function#async"),a(P(o)),Object.keys(r).forEach(s=>{u(s==="match"||s==="routeParams"||s==="precedence",`The Route Function ${n} returned an object with an unknown key \`{ ${s} }\`. Allowed keys: ['match', 'routeParams', 'precedence'].`)}),{precedence:i,routeParams:o}}function Pe(e,t){a(t.endsWith(" should")),f(e,"routeParams")&&(u(P(e.routeParams),`${t} be a plain JavaScript object.`),u(Object.values(e.routeParams).every(n=>typeof n=="string"),`${t} only hold string values.`))}async function Ot(e,t){const n=await e.onBeforeRoute(t),r=`The \`onBeforeRoute()\` hook exported by ${e.filePath}`;if(u(n==null||ht(n,["pageContext"])&&f(n,"pageContext"),`${r} should return \`null\`, \`undefined\`, or a plain JavaScript object \`{ pageContext: { /* ... */ } }\`.`),n==null)return null;if(u(f(n,"pageContext","object"),`${r} returned \`{ pageContext }\` but \`pageContext\` should be a plain JavaScript object.`),f(n.pageContext,"_pageId")&&!f(n.pageContext,"_pageId","null")){const o=`${r} returned \`{ pageContext: { _pageId } }\` but \`_pageId\` should be`;u(f(n.pageContext,"_pageId","string"),`${o} a string or \`null\``),u(t._allPageIds.includes(n.pageContext._pageId),`${o} one of following values: \`[${t._allPageIds.map(s=>`'${s}'`).join(", ")}]\`.`)}f(n.pageContext,"routeParams")&&Pe(n.pageContext,`${r} returned \`{ pageContext: { routeParams } }\` but \`routeParams\` should`);const i={};return f(n.pageContext,"url")&&(v(!1,`${r} returned \`{ pageContext: { url } }\` but \`pageContext.url\` has been renamed to \`pageContext.urlOriginal\`. Return \`{ pageContext: { urlOriginal } }\` instead. (See https://vite-plugin-ssr.com/migration/0.4.23 for more information.)`,{onlyOnce:!0}),n.pageContext.urlOriginal=n.pageContext.url,delete n.pageContext.url),f(n.pageContext,"urlOriginal")&&(u(f(n.pageContext,"urlOriginal","string"),`${r} returned \`{ pageContext: { urlOriginal } }\` but \`urlOriginal\` should be a string`),g(i,{_urlPristine:t.urlOriginal})),ye(n.pageContext,{hook:{hookFilePath:e.filePath,hookName:"onBeforeRoute"}}),g(i,n.pageContext),i}async function At(e){let t=null;const n=[];await Promise.all(e._pageFilesAll.filter(s=>s.fileType===".page.route").map(s=>{var l;return(l=s.loadFile)===null||l===void 0?void 0:l.call(s)})),e._pageFilesAll.filter(s=>s.fileType===".page.route"&&s.isDefaultPageFile).forEach(({filePath:s,fileExports:l})=>{if(a(l),"onBeforeRoute"in l){u(f(l,"onBeforeRoute","function"),`\`export { onBeforeRoute }\` of ${s} should be a function.`);const{onBeforeRoute:d}=l;t={filePath:s,onBeforeRoute:d}}"filesystemRoutingRoot"in l&&(u(f(l,"filesystemRoutingRoot","string"),`\`export { filesystemRoutingRoot }\` of ${s} should be a string.`),u(f(l,"filesystemRoutingRoot","string"),`\`export { filesystemRoutingRoot }\` of ${s} is \`'${l.filesystemRoutingRoot}'\` but it should start with a leading slash \`/\`.`),n.push({filesystemRoot:Ft(s),routeRoot:l.filesystemRoutingRoot}))});const r=e._allPageIds,i=[];return r.filter(s=>!De(s)).filter(s=>{const l=xt(s,e._pageFilesAll);if(!l)return!0;const{filePath:d,fileExports:h}=l;a(h),u("default"in h,`${d} should have a default export.`),u(f(h,"default","string")||f(h,"default","function"),`The default export of ${d} should be a string or a function.`),u(!("iKnowThePerformanceRisksOfAsyncRouteFunctions"in h)||f(h,"iKnowThePerformanceRisksOfAsyncRouteFunctions","boolean"),`The export \`iKnowThePerformanceRisksOfAsyncRouteFunctions\` of ${d} should be a boolean.`);const c=h.default;return i.push({pageId:s,filesystemRoute:null,pageRouteFile:{filePath:d,fileExports:h,routeValue:c}}),!1}).forEach(s=>{const l=Rt(s,n);a(l.startsWith("/")),a(!l.endsWith("/")||l==="/"),i.push({pageId:s,filesystemRoute:l,pageRouteFile:null})}),{pageRoutes:i,onBeforeRouteHook:t}}function xt(e,t){return t.find(n=>n.pageId===e&&n.fileType===".page.route")}function Ft(e){a(e.startsWith("/")),a(!e.endsWith("/"));const t=e.split("/"),n=_(t,0,-1).join("/")||"/";return a(n.startsWith("/")),a(!n.endsWith("/")||n==="/"),n}var C;function ee(...e){var t,n;C||(C=(n=(t=globalThis).__brillout_debug_createDebugger)===null||n===void 0?void 0:n.call(t,"vps:routing")),C&&C(...e)}async function we(e){K(e);const{pageRoutes:t,onBeforeRouteHook:n}=await At(e);ee("Pages routes:",t.map(c=>({pageId:c.pageId,filesystemRoute:c.filesystemRoute,pageRouteFile:c.pageRouteFile&&{filePath:c.pageRouteFile.filePath,routeValue:c.pageRouteFile.routeValue}})));const r={};if(n){const c=await Ot(n,e);if(c){if(g(r,c),f(r,"_pageId","string")||f(r,"_pageId","null"))return f(r,"routeParams")?a(f(r,"routeParams","object")):g(r,{routeParams:{}}),g(r,{_routingProvidedByOnBeforeRouteHook:!0,_routeMatches:"CUSTOM_ROUTE"}),{pageContextAddendum:r};g(e,r)}}g(r,{_routingProvidedByOnBeforeRouteHook:!1});const i=e._allPageIds;a(i.length>=0),u(i.length>0,"No `*.page.js` file found. You must create a `*.page.js` file, e.g. `pages/index.page.js` (or `pages/index.page.{jsx, tsx, vue, ...}`).");const{urlPathname:o}=e;a(o.startsWith("/"));const s=[];await Promise.all(t.map(async c=>{const{pageId:m,filesystemRoute:O,pageRouteFile:A}=c;if(A){const y=A.fileExports,w=A.filePath;if(f(y,"default","string")){const p=y.default;u(p.startsWith("/"),`A Route String should start with a leading \`/\` but \`${w}\` has \`export default '${p}'\`. Make sure to \`export default '/${p}'\` instead.`);const b=z(p,o);if(b){const{routeParams:N}=b;s.push({pageId:m,routeString:p,routeParams:N,routeType:"STRING"})}}else if(f(y,"default","function")){const p=await _t(y,e,w);if(p){const{routeParams:b,precedence:N}=p;s.push({pageId:m,precedence:N,routeParams:b,routeType:"FUNCTION"})}}else a(!1)}else{const y=vt(O,o);if(y){const{routeParams:w}=y;s.push({pageId:m,routeParams:w,routeType:"FILESYSTEM"})}}})),yt(s);const l=s[0];if(ee(`Route matches for URL \`${o}\` (in precedence order):`,s),g(r,{_routeMatches:s}),!l)return g(r,{_pageId:null,routeParams:{}}),{pageContextAddendum:r};const{pageId:d,routeParams:h}=l;return a(P(h)),g(r,{_pageId:d,routeParams:h}),{pageContextAddendum:r}}function Re(e){return a([!0,!1].includes(e.isHydration)),a([!0,!1,null].includes(e.isBackwardNavigation)),Ke(e)}const te=["urlPathname","urlParsed"],Tt=["Page","pageExports","exports"];function Se(e){[...Tt,...te].forEach(n=>{n in e&&(te.includes(n)?(a(n.startsWith("url")),v(!1,`\`pageContext.${n}\` is already available in the browser when using \`useClientRouter()\`; including \`${n}\` in \`passToClient\` has no effect.`,{onlyOnce:!0})):v(!1,`\`pageContext.${n}\` is a built-in that cannot be overriden; including \`${n}\` in \`passToClient\` has no effect.`,{onlyOnce:!0}),delete e[n])})}async function Ct(e){return e._isFirstRenderAttempt&&pe.isFirstUrl(e.urlOriginal)?(a(f(e,"_isFirstRenderAttempt","true")),It(e)):(a(f(e,"_isFirstRenderAttempt","false")),Et(e))}async function It(e){const t=Ge();return Se(t),g(t,{isHydration:!0,_comesDirectlyFromServer:!0}),g(t,await F(e._pageFilesAll,t._pageId)),t}async function kt(e){const t=ue(e._allPageIds);if(!t)throw new Error("No error page");const n={isHydration:!1,_pageId:t,_pageContextRetrievedFromServer:null,_comesDirectlyFromServer:!1};return g(n,await F(e._pageFilesAll,n._pageId)),n}async function Et(e){let t={};g(t,{isHydration:!1}),g(t,await $t(e)),g(t,await F(e._pageFilesAll,t._pageId));const n=await Wt({...e,...t});if(a([!0,!1].includes(n._comesDirectlyFromServer)),n._isError){t={},a(n._comesDirectlyFromServer===!0),a(f(n,"is404","boolean")),a(f(n,"pageProps","object")),a(f(n.pageProps,"is404","boolean")),a(!("serverSideError"in n));const r=ue(e._allPageIds);return a(r),g(t,{isHydration:!1,_pageId:r}),g(t,n),g(t,await F(e._pageFilesAll,t._pageId)),t}else return g(t,n),t}async function Wt(e){const t=ze(e,"onBeforeRender");if(t){const r=t.hook,i={_comesDirectlyFromServer:!1,_pageContextRetrievedFromServer:null},o=Re({...e,...i}),s=await r(o);ut(s,"onBeforeRender",["pageContext"],t.filePath);const l=s==null?void 0:s.pageContext;return g(i,l),i}else if((await lt(e._pageFilesAll,e._pageId)).hasOnBeforeRenderServerSideOnlyHook){const r=await jt(e),i={};return Object.assign(i,r),g(i,{_comesDirectlyFromServer:!0,_pageContextRetrievedFromServer:r}),i}return{_comesDirectlyFromServer:!1,_pageContextRetrievedFromServer:null}}async function $t(e){const n=(await we(e)).pageContextAddendum;if(!n._pageId)throw new Error("No routing match");return a(f(n,"_pageId","string")),n}async function jt(e){var t;const n=nt((t=e._urlPristine)!==null&&t!==void 0?t:e.urlOriginal,".pageContext.json",!0),r=await fetch(n);{const l=r.headers.get("content-type"),d=l&&l.includes("application/json");if(!d&&r.status===404){H(e.urlOriginal);const h=new Error("Page doesn't exist");throw Object.assign(h,{_abortRendering:!0}),h}u(d,`Wrong HTTP Response Header \`content-type\` value for URL ${n} (it should be \`application/json\` but we got \`${l}\`). Make sure to use \`pageContext.httpResponse.contentType\`, see https://github.com/brillout/vite-plugin-ssr/issues/191`)}const i=await r.text(),o=Ye(i);if("serverSideError"in o)throw Le("`pageContext` could not be fetched from the server as an error occurred on the server; check your server logs.");a(f(o,"pageContext"));const s=o.pageContext;return a(P(s)),a(f(s,"_pageId","string")),Se(s),s}let L;async function _e(){return L||(L=await Ht()),L}async function Ht(){const e=ge();ce(e);const t={_urlProcessor:null,_baseUrl:e,_objectCreatedByVitePluginSsr:!0,_isProduction:!0},{pageFilesAll:n,allPageIds:r}=await Je(!0);return g(t,{_pageFilesAll:n,_allPageIds:r}),t}async function Oe(e){const t=await _e(),n={urlOriginal:e,...t},r=t._pageFilesAll;K(n);const i=await we(n);if(!("pageContextAddendum"in i))return{pageId:null,pageFilesAll:r};const o=i.pageContextAddendum._pageId;return o?{pageId:o,pageFilesAll:r}:{pageId:null,pageFilesAll:r}}function W(e){return e.exportNames?e.exportNames:(a(e.fileExports,e.pageId),Object.keys(e.fileExports))}function Nt({pageFilesClientSide:e,pageFilesServerSide:t,pageId:n}){return{isHtmlOnly:r(),isClientRouting:o()};function r(){return t.some(d=>d.pageId===n&&d.fileType===".page")?(i(),!1):t.some(d=>d.pageId===n&&d.fileType===".page.server")}function i(){const s=e.some(l=>W(l).includes("render"));u(s,["No client-side `render()` hook found.","See https://vite-plugin-ssr.com/render-modes for more information.",["Loaded client-side page files (none of them `export { render }`):",...e.map((l,d)=>` (${d+1}): ${l.filePath}`)].join(`
`)].join(" "))}function o(){return e.some(l=>W(l).includes("clientRouting"))}}function Ut({pageFilesClientSide:e,pageFilesServerSide:t,isHtmlOnly:n,isClientRouting:r}){let i=[];const o=t.filter(l=>!e.includes(l)),s=[];if(s.push(...e.map(l=>({id:l.filePath,onlyAssets:!1}))),s.push(...o.map(l=>({id:l.filePath,onlyAssets:!0}))),n)i=e.map(l=>l.filePath);else{const l=r?"@@vite-plugin-ssr/dist/esm/client/router/entry.js":"@@vite-plugin-ssr/dist/esm/client/entry.js";s.push({id:l,onlyAssets:!1}),i=[l]}return{clientEntries:i,clientDependencies:s}}function Bt(e,t){let n=fe(e,t);const r=me(e,t),{isHtmlOnly:i,isClientRouting:o}=Nt({pageFilesClientSide:n,pageFilesServerSide:r,pageId:t});i&&(n=n.filter(d=>d.fileType===".page.client"&&!W(d).includes("render")),n=Vt(n));const{clientEntries:s,clientDependencies:l}=Ut({pageFilesClientSide:n,pageFilesServerSide:r,isHtmlOnly:i,isClientRouting:o});return{isHtmlOnly:i,isClientRouting:o,clientEntries:s,clientDependencies:l,pageFilesClientSide:n,pageFilesServerSide:r}}async function Lt(e,t,{sharedPageFilesAlreadyLoaded:n}){const r=fe(e,t);await Promise.all(r.map(async i=>{var o;a(i.fileType===".page"||i.fileType===".page.client"),!(n&&i.fileType===".page")&&await((o=i.loadExportNames)===null||o===void 0?void 0:o.call(i))}))}function Vt(e){const t=[];for(const n of e)if(t.push(n),W(n).includes("overrideDefaultPages"))break;return t}async function Ae(e){const{pageId:t,pageFilesAll:n}=await Oe(e);if(!t)return!1;await Lt(n,t,{sharedPageFilesAlreadyLoaded:!1});const{isHtmlOnly:r,isClientRouting:i}=Bt(n,t);return!r&&i}function xe(e){const t=e.getAttribute("href");return!!(t===null||t===""||he(t)||Dt(e)||Kt(t)||!Gt(t)||!Me(t))}function Dt(e){const t=e.getAttribute("target"),n=e.getAttribute("rel");return t==="_blank"||t==="_external"||n==="external"||e.hasAttribute("download")}function Kt(e){if(e.startsWith("#"))return!0;const t=n=>n.split("#")[0];return!!(e.includes("#")&&t(e)===t(window.location.href))}function Gt(e){const t=ge();ce(t);const{hasBaseUrl:n}=j(e,t);return n}function zt(e,t){const n=Yt(e,t);return{prefetchPageContext:!1,prefetchStaticAssets:n}}function Yt(e,t){let n=Jt(t),r=(()=>{if(n!==null)return n===!0?{when:"VIEWPORT"}:{when:"HOVER"};if("prefetchLinks"in e.exports&&u(n===null,"`export { prefetchLinks }` is deprecated, use `export { prefetchStaticAssets }` instead."),"prefetchStaticAssets"in e.exports){const{prefetchStaticAssets:i}=e.exports;if(i===!1)return!1;const o="`prefetchStaticAssets` should be either `false`, `{ when: 'VIEWPORT' }`, or `{ when: 'HOVER' }`";u(P(i),o);const s=Object.keys(i);u(s.length===1&&s[0]==="when",o);const{when:l}=i;if(l==="HOVER"||l==="VIEWPORT")return{when:l};u(!1,o)}return{when:"HOVER"}})();return r&&r.when==="VIEWPORT"&&!e._isProduction&&(oe(!1,"Viewport prefetching is disabled in development",{onlyOnce:!0}),r={when:"HOVER"}),r}function Jt(e){let t=e.getAttribute("data-prefetch");if(v(t===null,"The `data-prefetch` attribute is outdated.",{onlyOnce:!0}),t===null)return null;if(a(typeof t=="string"),t==="true")return!0;if(t==="false")return!1;u(!1,`Wrong data-prefetch value: \`"${t}"\`; it should be \`"true"\` or \`"false"\`.`)}const Fe=new Map;function Te(e){const t=Ie(e);return Fe.has(t)}function Ce(e){const t=Ie(e);Fe.set(t,!0)}function Ie(e){return et(e)}const ne=new Map;async function V(e){if(u(!he(e),`You are trying to prefetch ${e} which is an external URL. This doesn't make sense since vite-plugin-ssr cannot prefetch external links.`),Te(e))return;Ce(e);const{pageId:t,pageFilesAll:n}=await Oe(e);if(t)try{await F(n,t)}catch(r){if(de(r))He();else throw r}}function Mt(e){Ce(e.urlOriginal),[...document.getElementsByTagName("A")].forEach(async n=>{if(ne.has(n))return;ne.set(n,!0);const r=n.getAttribute("href");if(xe(n)||(a(r),!await Ae(r))||Te(r))return;const i=zt(e,n);if(i.prefetchStaticAssets){if(i.prefetchStaticAssets.when==="HOVER")n.addEventListener("mouseover",()=>V(r)),n.addEventListener("touchstart",()=>V(r),{passive:!0});else if(i.prefetchStaticAssets.when==="VIEWPORT"){const o=new IntersectionObserver(s=>{s.forEach(l=>{l.isIntersecting&&(V(r),o.disconnect())})});o.observe(n)}}else return})}function ke(){let e=window.history.state;e||(e={});let t=!1;"timestamp"in e||(t=!0,e.timestamp=We()),"scrollPosition"in e||(t=!0,e.scrollPosition=Ee()),$e(e),t&&J(e)}function Y(){const e=window.history.state||{};return $e(e),e}function Ee(){return{x:window.scrollX,y:window.scrollY}}function We(){return new Date().getTime()}function re(){const e=Ee(),t=Y();J({...t,scrollPosition:e})}function qt(e,t){if(t)J(Y(),e);else{const n=We();Xt({timestamp:n,scrollPosition:null},e)}}function $e(e){if(a(ae(e)),"timestamp"in e){const{timestamp:t}=e;a(typeof t=="number")}if("scrollPosition"in e){const{scrollPosition:t}=e;t!==null&&a(f(t,"x","number")&&f(t,"y","number"))}}function J(e,t){window.history.replaceState(e,"",t)}function Xt(e,t){window.history.pushState(e,"",t)}sn();ke();let I,je=!1;function He(){je=!0,oe(!1,"New deployed frontend detected. The next page navigation will use Server Routing instead of Client Routing.",{onlyOnce:!0})}function cn(){nn(),Qt((i,{keepScrollPosition:o})=>{r({scrollTarget:o?"preserve-scroll":"scroll-to-top-or-hash",url:i,isBackwardNavigation:!1})}),Zt((i,o)=>{r({scrollTarget:i,isBackwardNavigation:o})}),globalThis.__vite_plugin_ssr__navigate=async(i,{keepScrollPosition:o,overwriteLastHistoryEntry:s})=>{await r({scrollTarget:o?"preserve-scroll":"scroll-to-top-or-hash",url:i,overwriteLastHistoryEntry:s,isBackwardNavigation:!1})};let e=0,t,n=!1;r({scrollTarget:"preserve-scroll",isBackwardNavigation:null});return;async function r({scrollTarget:i,url:o=T(),overwriteLastHistoryEntry:s=!1,isBackwardNavigation:l}){var d,h;if(je){H(o);return}const c={urlOriginal:o,isBackwardNavigation:l},m=++e;a(m>=1),m>1&&n===!1&&(I==null||I(c),n=!0);const O=()=>rt()&&m===1?!1:m!==e,A=await _e();if(O())return;const y=m===1;g(c,{_isFirstRenderAttempt:y}),g(c,A),K(c);let w;try{w=await Ct(c)}catch(p){if(se(p,c))return;console.error(p);try{w=await kt(c)}catch(b){if(se(b,c)||(y||setTimeout(()=>{window.location.pathname=o},0),st(p,b)))return;throw b}}O()||(g(c,w),U(c,"onPageTransitionStart"),I=c.exports.onPageTransitionStart,t&&await t,!O()&&(en(o,s),pe.markNavigationChange(),a(t===void 0),t=(async()=>{const p=Re(c);qe(c);const b=await c.exports.render(p);u(b===void 0,"`export { render }` of "+c.exportsAll.render[0]._filePath+" should not return any value"),Mt(c)})(),await t,t=void 0,c._isFirstRenderAttempt?(U(c,"onHydrationEnd"),await((h=(d=c.exports).onHydrationEnd)===null||h===void 0?void 0:h.call(d,c))):m===e&&(c.exports.onPageTransitionEnd&&(U(c,"onPageTransitionEnd"),c.exports.onPageTransitionEnd(c)),n=!1),Ne(i),M(),Ue=!0))}}async function fn(e,{keepScrollPosition:t=!1,overwriteLastHistoryEntry:n=!1}={}){u(Xe(),"[`navigate(url)`] The `navigate(url)` function is only callable in the browser but you are calling it in Node.js."),u(e,"[navigate(url)] Missing argument `url`."),u(typeof e=="string",'[navigate(url)] Argument `url` should be a string (but we got `typeof url === "'+typeof e+'"`.'),u(typeof t=="boolean",'[navigate(url, { keepScrollPosition })] Argument `keepScrollPosition` should be a boolean (but we got `typeof keepScrollPosition === "'+typeof t+'"`.'),u(typeof n=="boolean",'[navigate(url, { overwriteLastHistoryEntry })] Argument `overwriteLastHistoryEntry` should be a boolean (but we got `typeof keepScrollPosition === "'+typeof n+'"`.'),u(e.startsWith("/"),"[navigate(url)] Argument `url` should start with a leading `/`.");const r=globalThis.__vite_plugin_ssr__navigate;a(r),await r(e,{keepScrollPosition:t,overwriteLastHistoryEntry:n})}function Qt(e){document.addEventListener("click",t);return;async function t(i){if(!n(i))return;const o=r(i.target);if(!o)return;const s=o.getAttribute("href");if(xe(o))return;if(a(s),i.preventDefault(),!await Ae(s)){H(s);return}const l=![null,"false"].includes(o.getAttribute("keep-scroll-position"));e(s,{keepScrollPosition:l})}function n(i){return i.button===0&&!i.ctrlKey&&!i.shiftKey&&!i.altKey&&!i.metaKey}function r(i){for(;i.tagName!=="A";){const{parentNode:o}=i;if(!o)return null;i=o}return i}}let S=$();function Zt(e){window.addEventListener("popstate",()=>{const t=$(),n=t.historyState.scrollPosition||"scroll-to-top-or-hash",r=t.urlWithoutHash===S.urlWithoutHash,i=!t.historyState.timestamp||!S.historyState.timestamp?null:t.historyState.timestamp<S.historyState.timestamp;S=t,r?window.history.state===null?(ke(),S=$()):Ne(n):e(n,i)})}function en(e,t){T()!==e&&(M(),qt(e,t),S=$())}function $(){return{urlWithoutHash:T({withoutHash:!0}),historyState:Y()}}function Ne(e){if(e==="preserve-scroll")return;let t;if(e==="scroll-to-top-or-hash"){const n=rn();if(n&&n!=="top"){const r=document.getElementById(n)||document.getElementsByName(n)[0];if(r){r.scrollIntoView();return}}t={x:0,y:0}}else a("x"in e&&"y"in e),t=e;tn(t)}function tn(e){const t=()=>window.scrollTo(e.x,e.y),n=()=>window.scrollX===e.x&&window.scrollY===e.y;n()||(t(),!n()&&requestAnimationFrame(()=>{t(),!n()&&setTimeout(async()=>{if(t(),n())return;const r=new Date().getTime();for(;;)if(await ot(10),t(),n()||new Date().getTime()-r>100)return},0)}))}function nn(){window.addEventListener("scroll",Ze(re,Math.ceil(1e3/3)),{passive:!0}),Be(re)}function rn(){let{hash:e}=window.location;return e===""?null:(a(e.startsWith("#")),e=e.slice(1),e)}let Ue=!1;function sn(){ie(),Be(ie),on(()=>Ue&&M())}function M(){"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual")}function ie(){"scrollRestoration"in window.history&&(window.history.scrollRestoration="auto")}function Be(e){window.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&e()})}function on(e){window.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&e()})}function se(e,t){return!!(e!=null&&e._abortRendering||an(e,t))}function an(e,t){if(!de(e))return!1;if(He(),t._isFirstRenderAttempt)throw e;return H(t.urlOriginal),!0}export{fn as n,cn as u};